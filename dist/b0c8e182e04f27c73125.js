(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{354:function(t,r){},397:function(t,r,e){},421:function(t,r,e){"use strict";var o=e(397);e.n(o).a},444:function(t,r,e){"use strict";e.r(r);var o=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("form",{staticClass:"works-form"},[e("div",{staticClass:"admin__title admin__title--form"},[t._v(t._s(t.formTitle))]),e("div",{staticClass:"works-form__content"},[e("div",{staticClass:"works-form__photo"},[e("label",{staticClass:"works-form__upload-block"},[e("div",{staticClass:"form__upload-photo-container",class:{filled:t.renderedPhoto.length,error:t.validation.firstError("renderedPhoto")},style:{backgroundImage:"url("+this.renderedPhoto+")"}},[e("input",{staticClass:"form__upload-photo-input",attrs:{type:"file"},on:{change:t.appendRenderPhoto}}),e("div",{staticClass:"form__upload-photo-content",class:{filled:t.renderedPhoto.length}},[e("span",{staticClass:"form__upload-photo-desc"},[t._v("Перетащите или загрузите для загрузки изображения")]),e("div",{staticClass:"btn btn--work-form"},[t._v("ЗАГРУЗИТЬ")])]),e("div",{staticClass:"form__upload-photo-error"},[e("error-tooltip",{attrs:{errorText:t.validation.firstError("renderedPhoto")}})],1)])])]),e("div",{staticClass:"works-form__desk"},[e("div",{staticClass:"works-form__row"},[e("div",{staticClass:"works-form__col"},[e("label",{staticClass:"works-form__block",class:{error:t.validation.firstError("work.title")}},[e("div",{staticClass:"works-form__block-title"},[t._v("Название")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.work.title,expression:"work.title"}],staticClass:"works-form__field",attrs:{type:"text",name:"name",placeholder:"Введите название"},domProps:{value:t.work.title},on:{input:function(r){r.target.composing||t.$set(t.work,"title",r.target.value)}}}),e("div",{staticClass:"form__text-block-error"},[e("error-tooltip",{attrs:{errorText:t.validation.firstError("work.title")}})],1)])])]),e("div",{staticClass:"works-form__row"},[e("div",{staticClass:"works-form__col"},[e("label",{staticClass:"works-form__block",class:{error:t.validation.firstError("work.link")}},[e("div",{staticClass:"works-form__block-title"},[t._v("Ссылка")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.work.link,expression:"work.link"}],staticClass:"works-form__field",attrs:{type:"text",name:"link",placeholder:"Вставьте ссылку"},domProps:{value:t.work.link},on:{input:function(r){r.target.composing||t.$set(t.work,"link",r.target.value)}}}),e("div",{staticClass:"form__text-block-error"},[e("error-tooltip",{attrs:{errorText:t.validation.firstError("work.link")}})],1)])])]),e("div",{staticClass:"works-form__row"},[e("div",{staticClass:"works-form__col"},[e("label",{staticClass:"works-form__block",class:{error:t.validation.firstError("work.description")}},[e("div",{staticClass:"works-form__block-title"},[t._v("Описание")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.work.description,expression:"work.description"}],staticClass:"works-form__field works-form__field--textarea",attrs:{name:"description",rows:"4",placeholder:"Введите описание работы"},domProps:{value:t.work.description},on:{input:function(r){r.target.composing||t.$set(t.work,"description",r.target.value)}}}),e("div",{staticClass:"form__text-block-error"},[e("error-tooltip",{attrs:{errorText:t.validation.firstError("work.description")}})],1)])])]),e("div",{staticClass:"works-form__row works-form__row--add-tags"},[e("div",{staticClass:"works-form__col"},[e("label",{staticClass:"works-form__block"},[e("div",{staticClass:"works-form__block-title"},[t._v("Добавление тэга")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.work.techs,expression:"work.techs"}],staticClass:"works-form__field",attrs:{type:"text",name:"tags",placeholder:"Вставьте ссылку"},domProps:{value:t.work.techs},on:{change:function(r){return t.ADD_TAGS(t.work.techs)},input:function(r){r.target.composing||t.$set(t.work,"techs",r.target.value)}}})])])]),e("div",{staticClass:"works-form__row works-form__row--tags"},[t.editMode?e("div",{staticClass:"works-form__col"},[e("div",{staticClass:"works-form__tags"},[e("form-tags")],1)]):t._e()]),e("div",{staticClass:"works-form__row works-form__row--btns"},[e("div",{staticClass:"works-form__btns"},[e("button",{staticClass:"btn btn--work-cancel",attrs:{type:"button"},on:{click:t.closeForm}},[t._v("Отмена")]),t.editMode?t._e():e("button",{staticClass:"btn btn--work-form",attrs:{type:"button"},on:{click:t.addNewWork}},[t._v("Сохранить")]),t.editMode?e("button",{staticClass:"btn btn--work-form",attrs:{type:"button"},on:{click:t.editCurrentWork}},[t._v("Сохранить")]):t._e()])])])])])};o._withStripped=!0;var s=e(97),i=e(65);function a(t,r,e,o,s,i,a){try{var n=t[i](a),c=n.value}catch(t){return void e(t)}n.done?r(c):Promise.resolve(c).then(o,s)}function n(t){return function(){var r=this,e=arguments;return new Promise(function(o,s){var i=t.apply(r,e);function n(t){a(i,o,s,n,c,"next",t)}function c(t){a(i,o,s,n,c,"throw",t)}n(void 0)})}}function c(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{},o=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(e).filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.forEach(function(r){l(t,r,e[r])})}return t}function l(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}var d={mixins:[e(65).mixin],validators:{renderedPhoto:function(t){return i.Validator.value(t).required("Загрузите картинку")},"work.title":function(t){return i.Validator.value(t).required("Введите название")},"work.link":function(t){return i.Validator.value(t).required("Вставьте ссылку")},"work.description":function(t){return i.Validator.value(t).required("Введите описание")},editedTags:function(t){return i.Validator.value(t).required("Работа должна содержать теги навыков")}},components:{formTags:function(){return e.e(21).then(e.bind(null,451))},errorTooltip:function(){return e.e(0).then(e.bind(null,448))}},data:function(){return{renderedPhoto:"",work:{title:"",techs:"",photo:"",link:"",description:""}}},computed:c({},Object(s.e)("works",{editMode:function(t){return t.editMode},editedTags:function(t){return t.editedTags},editedWork:function(t){return t.editedWork}}),{formTitle:function(){switch(this.editMode){case!0:return"Редактирование работы";case!1:return"Новая работа"}},remotePhoto:function(){return"https://webdev-api.loftschool.com/".concat(this.work.photo)},editedTagsString:function(){return this.editedTags.join(",")}}),methods:c({},Object(s.d)("tooltip",["SHOW_TOOLTIP"]),Object(s.d)("works",["CLOSE_FORM","EDIT_MODE_OFF","ADD_TAGS"]),Object(s.b)("works",["addWork","editWork"]),{closeForm:function(){this.CLOSE_FORM(),this.EDIT_MODE_OFF()},appendRenderPhoto:function(t){var r=this,e=t.target.files[0];this.work.photo=e;var o=new FileReader;try{o.readAsDataURL(e),o.onload=function(){r.renderedPhoto=o.result}}catch(t){alert(t)}},addNewWork:function(){var t=n(regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,r=this.createFormDataWork(),t.next=9,this.addWork(r);case 9:this.CLOSE_FORM(),this.SHOW_TOOLTIP({type:"success",text:"Работа добавлена"}),t.next=16;break;case 13:t.prev=13,t.t1=t.catch(5),this.SHOW_TOOLTIP({type:"error",text:t.t1.response.data.error});case 16:case"end":return t.stop()}},t,this,[[5,13]])}));return function(){return t.apply(this,arguments)}}(),createFormDataWork:function(){var t=new FormData;if(t.append("title",this.work.title),this.editMode){var r=this.editedTags.join(",");t.append("techs",r),console.log(r)}else t.append("techs",this.work.techs);return t.append("photo",this.work.photo),t.append("link",this.work.link),t.append("description",this.work.description),t},editCurrentWork:function(){var t=n(regeneratorRuntime.mark(function t(){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,r={id:this.work.id,data:this.createFormDataWork()},t.next=9,this.editWork(r);case 9:this.EDIT_MODE_OFF(),this.CLOSE_FORM(),this.SHOW_TOOLTIP({type:"success",text:"Работа обнавлена"}),t.next=17;break;case 14:t.prev=14,t.t1=t.catch(5),this.SHOW_TOOLTIP({type:"error",text:t.t1.response.data.error});case 17:case"end":return t.stop()}},t,this,[[5,14]])}));return function(){return t.apply(this,arguments)}}()}),created:function(){this.editMode&&(this.work=c({},this.editedWork),this.renderedPhoto=this.remotePhoto,this.work.techs="")}},u=(e(421),e(96)),f=Object(u.a)(d,o,[],!1,null,"43e6de8e",null);f.options.__file="src/admin/components/works/worksForm.vue";r.default=f.exports}}]);